<!DOCTYPE html>
<html lang="en">
<script src="https://kit.fontawesome.com/22ffc91bdd.js" crossorigin="anonymous"></script>

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="date" content='2023-02-17'>

    <link rel="apple-touch-icon" sizes="180x180" href="../favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon/favicon-16x16.png">
    <link rel="manifest" href="../favicon/site.webmanifest">

    <title>Unitary Fund</title>
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="../style.css">
    <link rel="stylesheet" type="text/css" href="../hamburgers.min.css">

    <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
    <style type="text/css">
        #mc_embed_signup {
            background: #fff;
            clear: left;
            font: 14px "Lucida Console", Monaco, monospace;
            width: 100%;
        }
        
        #mce-EMAIL {
            padding: 11px;
            margin: 10px;
        }
    </style>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19932157-4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-19932157-4');
    </script>
    <title>HierarQcal - A quick and easy way to build or generate Quantum Convolutional Neural Networks</title>
</head>

<body>
    <div class="layout">
        <main id="content" class="content">
            <section class="heavy">
                <div class="container">
                    <div class="col-3">
                        <div class="hero">
                            <a href="/"><img src="/logos/logov3.svg" alt="Unitary Fund" /></a>
                            <p class="tagline"><b>Because evolution is
                                    <a href="https://en.wikipedia.org/wiki/Unitarity_(physics)"
                                        target="_blank">unitary</a></b>.</p>
                            <button id="mobile-menu-icon" class="hamburger hamburger--squeeze" type="button">
                                <span class="hamburger-box">
                                    <span class="hamburger-inner"></span>
                                </span>
                            </button>
                        </div>
                        <section class="light">


                            <right>
                                <h2 class="leading-arrow">HierarQcal - A quick and easy way to build or generate Quantum Convolutional Neural Networks</h2>
                                <h3></h3>
                            </right>
                            2023-02-17
                            <br> Matt Lourens


                            <div>
                                <style>
                                .center {
                                  display: block;
                                  margin-left: auto;
                                  margin-right: auto;
                                  width: 100%;
                                }
                                </style>
                                <p>A typical quantum machine learning
                                workflow consists of various components,
                                each influencing the next to ultimately
                                determine model performance. For
                                example, if you want to build a quantum
                                model for music genre classification, a
                                pipeline might look something like this
                                (from <a
                                href="https://arxiv.org/abs/2210.15073#">Lourens
                                et al.</a>):</p>
                                <p><img
                                src="../images/2023_hierarqcal_qcnn_pipeline.svg"
                                class="center" /></p>
                                <p>Better models require better control
                                over these components and a particularly
                                important one is quantum circuit design.
                                This is because it contributes largely
                                to the expressivity, trainability, and
                                computational complexity of your model.
                                There are multiple levels to quantum
                                circuit design, from the choice of
                                combining individual quantum gates for
                                different unitary operations, to the
                                placement of these unitaries across the
                                circuit. In the pipeline shown above,
                                the circuit design is an instance of the
                                <a
                                href="https://www.nature.com/articles/s41567-019-0648-8">Quantum
                                Convolutional Neural Network</a> (QCNN)
                                which is a quantum circuit architecture
                                inspired by Convolutional Neural
                                Networks (CNNs). The main properties of
                                QCNNs are:</p>
                                <ul>
                                <li>Convolutions: a layer of identical
                                unitaries applied in a translationally
                                invariant manner on available
                                qubits.</li>
                                <li>Pooling: a layer of measurements on
                                a subset of qubits with rotations based
                                on measurement outcomes applied to the
                                remaining qubits.</li>
                                <li>Weight sharing between unitaries in
                                the same layer.</li>
                                </ul>
                                <p>The result is a space of circuit
                                architectures that tend to be more
                                computationally feasible (due to the
                                weight sharing and systematic reduction
                                of system size) and that show promising
                                classification performance (<a
                                href="https://www.nature.com/articles/s41567-019-0648-8">Cong
                                et al.</a>, <a
                                href="https://www.nature.com/articles/s41534-018-0116-9">Grant
                                et al.</a>, <a
                                href="https://arxiv.org/abs/2210.15073#">Lourens
                                et al.</a>). Two instances of this space
                                are shown below:</p>
                                <p><img
                                src="../images/2023_hierarqcal_compare_right_inside.drawio.svg"
                                class="center" /></p>
                                <p>Now while these circuits are easy to
                                understand geometrically, i.e. the first
                                “pools” half the available qubits from
                                bottom to top and the second from inside
                                out, their implementation can be
                                cumbersome. This is because you have to
                                loop through all qubits and keep track
                                of indices that correspond to the
                                correct architectural operations like
                                convolutions or pooling. For example, if
                                you have code for QCNN 1 and want to
                                change it to QCNN 2, it ends up being an
                                unnecessarily involved process even
                                though they only differ in a small
                                conceptual way. This is where <strong><a
                                href="https://github.com/matt-lourens/hierarqcal">HierarQcal</a></strong>
                                comes in, it enables the design of
                                quantum circuits in an intuitive way. In
                                fact, the circuits shown above were
                                generated with the following two lines
                                of code:</p>
                                <script src="https://gist.github.com/matt-lourens/dd1913e04d9d46ec0402cab907541614.js"></script>
                                <p>Semantically QCNN 1 is 8 qubits
                                (<code>Qfree(8)</code>) with a
                                convolution of stride 1
                                (<code>Qconv(1)</code>) and pooling from
                                bottom to top
                                (<code>Qpool("right")</code>) repeated
                                three times (<span
                                class="math inline">⋅</span>, <span
                                class="math inline">⋅</span>)*3. As you
                                can see the code resembles the verbal
                                description of the architecture. It also
                                captures the fact that the only
                                difference between QCNN 1 and QCNN 2 is
                                the pooling direction. This is the idea
                                behind HierarQcal, to provide a way of
                                capturing the design motifs of a quantum
                                circuit in a hierarchical fashion. For
                                example, the bottom-to-top QCNN above
                                can be described with three levels of
                                motifs:</p>
                                <p><img
                                src="../images/2023_hierarqcal_motifs.drawio.svg"
                                class="center" /></p>
                                <p>The motifs on the first level we call
                                primitives, the bottom-to-top QCNN has
                                two: a convolution of stride 1 and
                                pooling from bottom to top. One level up
                                the hierarchy we create another motif
                                that alternates between the two
                                primitives, a convolution-pooling unit.
                                The third level motif is three
                                convolution-pooling units repeated. This
                                final motif, which is one directed
                                graph, contains the full QCNN
                                architecture. You can check the paper
                                (<a
                                href="https://arxiv.org/abs/2210.15073#">Lourens
                                et al.</a>) for the full theoretical
                                framework, but basically, the effect of
                                a primitive is based on its
                                hyperparameters and the effect of its
                                predecessor. This way, their individual
                                and combined architectural effects are
                                captured, enabling them to be
                                dynamically stacked one after another to
                                form second level <span
                                class="math inline"><em>l</em> = 2</span>
                                motifs. Stacking these stacks in
                                different ways constitutes higher-level
                                motifs until a final level <span
                                class="math inline"><em>l</em> = <em>L</em></span>,
                                where one motif constitutes the entire
                                QCNN architecture.</p>
                                <p>This hierarchical view is
                                particularly useful for architecture
                                search, algorithms that automatically
                                design model architectures (such as for
                                the QCNN). The main idea is to use
                                smaller operations as building blocks
                                for larger ones which result in an
                                expressive representation that mimics
                                design elements typically performed by
                                humans. In classical machine learning
                                literature, the field of neural
                                architecture search (NAS) explores
                                architecture representations as part of
                                automated neural network construction.
                                In particular, hierarqcal was inspired
                                by the hierarchical representation
                                presented in this paper by <a
                                href="https://openreview.net/pdf?id=BJQRKzbA-">Liu
                                et al.</a>.</p>
                                <p><img class="center"src="../images/2023_hierarqcal_dalle_img.png" style="width:200px;border: 1px black solid; margin-right: 10px;" align="left"/></p>
                                <p>Speaking of inspiration, our logo
                                comes from <a
                                href="https://openai.com/dall-e-2/">Dall
                                E 2</a> presented with the following
                                prompt: <em>A robot building itself with
                                artificial intelligence, pencil
                                drawing</em></p>
                                <p>Which touches on the idea of a robot
                                building another, in some way hierarqcal
                                is the pencil that allows you or a robot
                                to “draw” quantum circuits. <br/></p>
                                <p>There’s a bunch of <a
                                href="https://matt-lourens.github.io/hierarqcal/getting_started.html#basic-usage">docs
                                and tutorials</a> that can get you
                                started with building QCNNs or creating
                                algorithms that generate them. Some
                                useful things to mention are:</p>
                                <ul>
                                <li>The package is quantum computing
                                framework agnostic, so you can use it
                                with any framework (e.g., Qiskit, Cirq,
                                Pennylane) or your own, as long as it’s
                                in python. This is because the
                                architecture representation is just a
                                data structure and the package allows
                                you to interact with it.</li>
                                <li>It’s quick and easy to create a
                                space of architectures which you can
                                randomly sample to find good-performing
                                circuits for your specific problem/data.
                                This is a nice way get baseline
                                performance for your model. See this <a
                                href="https://matt-lourens.github.io/hierarqcal/examples/examples_cirq.html#random-qcnns">tutorial</a>
                                on how to do it.</li>
                                <li>It’s open source! So if you have
                                cool ideas for quantum circuit
                                primitives, feel free to add them. So
                                far we have Qconv, Qpool and Qdense, but
                                there are many possibilities that can be
                                explored based on symmetry, locality,
                                etc.</li>
                                </ul>
                                <p>In all examples so far we’ve used CRZ
                                and CNOT gates for convolutions and
                                pooling, but this is arbitrary, it’s
                                easy to create a custom unitary which
                                you pass to a primitive, for
                                instance:</p>
                                <p><img
                                src="../images/2023_hierarqcal_convstride.drawio.svg"
                                class="center" /></p>
                                Where the corresponding code is:
                                <script src="https://gist.github.com/matt-lourens/6cc14d37209de07abd707804f1b0219e.js"></script>
                                <p>And here is a quick gif to highlight
                                the design process:</p>
                                <p><img
                                src="../images/2023_hierarqcal_code.gif"
                                class="center" /></p>
                                <p>That’s it for now, a big shout out to
                                the <a
                                href="https://unitary.fund/">Unitary
                                Fund</a> that made all of this possible!
                                If you have any questions or comments,
                                feel free to reach out to me on twitter
                                <a
                                href="https://twitter.com/MeMattLourens">MeMattLourens</a>.</p>
                                <p>Useful Links:</p>
                                <ul>
                                <li><a
                                href="https://github.com/matt-lourens/hierarqcal">The
                                package</a></li>
                                <li><a
                                href="https://arxiv.org/abs/2210.15073#">The
                                paper</a></li>
                                <li><a
                                href="https://matt-lourens.github.io/hierarqcal/getting_started.html#basic-usage">The
                                docs</a></li>
                                <li><a
                                href="https://www.nature.com/articles/s41567-019-0648-8">The
                                Cong et al. QCNN paper</a></li>
                                <li><a
                                href="https://openreview.net/pdf?id=BJQRKzbA-">The
                                Liu et al. NAS paper</a></li>
                                </ul>
                                <!--
                                Thanks for contributing a blog post to the UF site!

                                Some quick tips:
                                - Use the `title` field to set the title of your post, no first level header needed.
                                - Standard markdown formatting is supported (code blocks, links, images, etc.)
                                  - Put images for your post in the `images` folder.
                                - If you need further custom formatting, direct html will work here as well.
                                - 
                                pandoc --standalone --template pandoc-template.html ./_markdown/2023_hierarqcal.md -o 2023_hierarqcal.html

                                NOTE: If this post needs external attribution, include the line below at the very top.
                                > _This blog was originally posted [here](), and is reproduced with the author's permission._ -->
                            </div>

                        </section>
                        <footer class="footer leading-arrow light-arrow">
                            This website is hosted on <a href="https://github.com/unitaryfund/unitary-fund" target="_blank">github</a>, and our community follows this <a href="https://github.com/unitaryfund/unitary-fund/blob/master/CODE_OF_CONDUCT.md">code
                                of conduct</a>. <br> <br> If you have suggestions for changes then please open up a pull request!
                            <br>
                            <br>
                            <table>
                                <tr>
                                    <th style="text-align: right;"><a href="https://twitter.com/unitaryfund"><i
                                                class="fa fa-twitter"></i></a></th>
                                    <th style="text-align: right;"><a href="https://twitch.tv/unitaryfund"><i
                                                class="fa fa-twitch"></i></a></th>
                                    <th style="text-align: right;"><a href="https://www.youtube.com/channel/UCDbDLAzGRTHnhkoMMOX7D1A"><i
                                                class="fa fa-youtube"></i></a></th>
                                    <th style="text-align: right;"><a href="http://discord.unitary.fund"><i
                                                class="fab fa-discord"></i></a></th>
                                </tr>
                            </table> &copy;2020-2023 Unitary Fund
                        </footer>
                    </div>
                    <div class="col-1" id="menu-container">
                        <table style="width:auto; margin-right:0px; margin-left: auto;">
                            <tr>
                                <th style="text-align: right;"><a href="https://twitter.com/unitaryfund"><i
                                            class="fa fa-twitter"></i></a></th>
                                <th style="text-align: right;"><a href="https://twitch.tv/unitaryfund"><i
                                            class="fa fa-twitch"></i></a></th>
                                <th style="text-align: right;"><a href="https://www.youtube.com/channel/UCDbDLAzGRTHnhkoMMOX7D1A"><i
                                            class="fa fa-youtube"></i></a></th>
                                <th style="text-align: right;"><a href="http://discord.unitary.fund"><i
                                            class="fab fa-discord"></i></a></th>
                            </tr>
                        </table>
                        <p class="light" id="menu">
                            <a href="../grants.html">grants</a>
                            <a href="../ideas.html">ideas</a>
                            <a href="../research.html">research</a>
                            <a href="../mitiq.html">mitiq</a>
                            <a href="https://metriq.info/About">metriq</a>
                            <a href="../talks.html">events</a>
                            <a href="../faq.html">faq</a>
                            <a href="../blog.html" class="active">blog</a>
                            <a href="../careers.html">careers</a>
                            <a href="../donate.html">donate</a>
                            <a href="https://shop.spreadshirt.com/unitaryfund/">shop</a>
                            <a href="https://unitaryfund.typeform.com/to/j0kAOd" target="_blank" class="highlight">apply</a>
                        </p>
                    </div>
                    <div id="mobile-menu-container">
                        <p class="light" id="mobile-menu">
                            <a href="../grants.html">grants</a>
                            <a href="../ideas.html">ideas</a>
                            <a href="../research.html">research</a>
                            <a href="../mitiq.html">mitiq</a>
                            <a href="https://metriq.info/About">metriq</a>
                            <a href="../talks.html">events</a>
                            <a href="../faq.html">faq</a>
                            <a href="../blog.html" class="active">blog</a>
                            <a href="../careers.html">careers</a>
                            <a href="../donate.html">donate</a>
                            <a href="https://shop.spreadshirt.com/unitaryfund/">shop</a>
                            <a href="https://unitaryfund.typeform.com/to/j0kAOd" target="_blank" class="highlight">apply</a>
                        </p>
                    </div>
                </div>

            </section>
        </main>
    </div>
    <script>
        var mobileMenuIcon = document.querySelector("#mobile-menu-icon")
        mobileMenuContainer = document.querySelector("#mobile-menu-container");
        mobileMenuIcon.addEventListener("click", function() {
            mobileMenuIcon.classList.toggle("is-active");
            mobileMenuContainer.classList.toggle("active");
        });
    </script>
</body>

</html>
